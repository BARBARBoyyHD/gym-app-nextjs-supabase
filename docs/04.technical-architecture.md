
---

# üèóÔ∏è Technical Architecture ‚Äî Fitness Membership Web App

## 1. Overview

Aplikasi ini merupakan platform membership gym dengan kemampuan:

* Registrasi dan login admin via Supabase Auth
* Manajemen data member
* Paket membership (plans)
* Transaksi pembayaran
* Sistem kursus dengan embed video
* Dashboard operasional admin

Backend menggunakan **Node.js + Express**, database **PostgreSQL**, penyimpanan media via **Supabase Storage**, autentikasi admin via **Supabase Auth**, serta frontend **React + Supabase Client**.

---

## 2. System Components

### 2.1 Frontend

* **Framework**: React.js (SPA)
* **Routing**: React Router
* **State Management**: Context API / Zustand (opsional)
* **API Communication**: Fetch API / Supabase JS Client
* **Video Player**: React Player / HTML5 `<iframe>` (YouTube/Vimeo embed link)
* **Role**: Menampilkan UI dashboard admin & CRUD data membership.

### 2.2 Backend (Custom API)

* **Tech Stack**: Node.js + Express
* **Responsibilities**:

  * CRUD membership (members table)
  * CRUD plans
  * CRUD payments
  * CRUD courses
  * Validation
  * Business logic handling
* **Security**:

  * JWT middleware (opsional)
  * Supabase Auth token validation

### 2.3 Authentication

* **Provider**: Supabase Auth
* **Flow**:

  1. Admin login: email + password
  2. Supabase return JWT
  3. JWT attached in every backend request via `Authorization: Bearer <token>`

**Notes**

> Hanya admin yang login. Members tidak login, karena hanya pencatatan.

### 2.4 Database

* **Engine**: PostgreSQL
* **Host**: Supabase / Neon / Railway (recommended cloud)
* **Tables**:

  * `members` ‚Üí data member
  * `plans` ‚Üí harga & durasi membership
  * `payments` ‚Üí bukti pembayaran
  * `courses` ‚Üí link embed video + deskripsi materi

### 2.5 Storage

* **Provider**: Supabase Storage
* **Usage**:

  * Upload bukti pembayaran (optional)
  * Upload thumbnail course (optional)

### 2.6 Video Embedding

* Tidak menyimpan file video.
* Disimpan sebagai **embed URL**:

  ```
  https://www.youtube.com/embed/xxxx
  ```
* Ditampilkan dengan `<iframe>`

### 2.7 Deployment

* **Frontend** ‚Üí Vercel / Netlify
* **Backend** ‚Üí Vercel (serverless) atau Railway
* **Database** ‚Üí Supabase PostgreSQL
* **Auth & Storage** ‚Üí Supabase

---

## 3. Architecture Diagram (Logical)

```
               [Admin User]
                    |
                 (Login)
                    |
           +------------------+
           | Supabase Auth    |
           +------------------+
                    |
               JWT Token
                    |
+---------------------------------------+
|           React Frontend              |
| (Dashboard, Forms, Video Player)      |
+---------------------------------------+
        |                     |
        | Fetch API           | Supabase Client
        v                     v
+---------------------------------------+
|         Node.js Express API           |
|  (CRUD members, plans, payments,        |
|   courses, validation, business)      |
+---------------------------------------+
                    |
                SQL Queries
                    |
+---------------------------------------+
|            PostgreSQL DB              |
| (members, plans, payments, courses)     |
+---------------------------------------+
                    |
                File Storage
                    |
+---------------------------------------+
|           Supabase Storage            |
+---------------------------------------+
```

---

## 4. API Design

### Base URL

```
/api/v1/
```

### Endpoints (summary)

| Method | Endpoint      | Description            |
| ------ | ------------- | ---------------------- |
| POST   | `/auth/login` | Get Supabase JWT       |
| GET    | `/members`    | List all members       |
| POST   | `/members`    | Create member          |
| PUT    | `/members/:id`| Update member          |
| DELETE | `/members/:id`| Delete member          |
| GET    | `/plans`      | List membership plans  |
| POST   | `/plans`      | Create plan            |
| GET    | `/payments`   | List payments          |
| POST   | `/payments`   | Create payment         |
| GET    | `/courses`    | List all course videos |
| POST   | `/courses`    | Add course video embed |

---

## 5. Data Flow

### 5.1 Add Member

1. Admin ‚Üí Login Supabase Auth
2. Admin ‚Üí Form "Add member"
3. Frontend ‚Üí POST `/members`
4. Backend ‚Üí insert into `members` table
5. Response success

### 5.2 Add Course Video

1. Admin ‚Üí Form (title + description + embed URL)
2. Frontend ‚Üí POST `/courses`
3. Backend ‚Üí insert into DB
4. Frontend ‚Üí display iframe

### 5.3 Add Payment

1. Admin ‚Üí Upload bukti bayar (optional)
2. Frontend ‚Üí POST `/payments` with file
3. Backend:

   * Upload to Supabase Storage
   * Save URL to DB

---

## 6. Security Architecture

* HTTPS enforced
* JWT middleware in backend
* CORS allow only frontend domain
* Rate limit on Express API (`express-rate-limit`)
* Supabase Auth Sessions

### Role

* **Admin** only
* No member login required

---

## 7. Scalability Considerations

| Feature       | Plan                                       |
| ------------- | ------------------------------------------ |
| Video hosting | External (YouTube/Vimeo), no heavy storage |
| DB growth     | Partition by year for payments             |
| Backup        | Supabase scheduled backup                  |
| API scaling   | Stateless ‚Üí serverless friendly            |

---

## 8. Tech Stack Choices (Why)

### Why Supabase Auth?

* Simple session based login
* Token-based auth compatible with Express

### Why PostgreSQL?

* Strong relationship support
* Better modeling for membership + payments

### Why embed video (not upload)?

* **Cost down**
* No bandwidth issues
* Faster performance

### Why Vercel deployment?

* Zero config
* Auto HTTPS
* Scalability serverless mode

---

## 9. Risks & Mitigation

| Risk                   | Mitigation                            |
| ---------------------- | ------------------------------------- |
| Admin loses access     | Secondary admin credential            |
| Bad embed links        | Regex validation YouTube/Vimeo        |
| Serverless cold start  | Cache plans, courses                  |
| Corrupted payment data | Enforce DB constraints & transactions |

---

